<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Youtube Top 20 Content Creators | Data Engineering Portfolio</title>
<meta name="generator" content="Jekyll v4.3.2">
<meta property="og:title" content="Youtube Top 20 Content Creators">
<meta name="author" content="Bruce A. Lee">
<meta property="og:locale" content="en_US">
<meta name="description" content="Introduction: Hello! In this project, I’m breaking down the top content creators on Youtube over 2017-2018. The very first thing i’ll do is load the libraries I’m going to use:">
<meta property="og:description" content="Introduction: Hello! In this project, I’m breaking down the top content creators on Youtube over 2017-2018. The very first thing i’ll do is load the libraries I’m going to use:">
<link rel="canonical" href="/projects/2023/07/19/youtube_analysis.html">
<meta property="og:url" content="/projects/2023/07/19/youtube_analysis.html">
<meta property="og:site_name" content="Data Engineering Portfolio">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-07-19T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Youtube Top 20 Content Creators">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Bruce A. Lee"},"dateModified":"2023-07-19T00:00:00+00:00","datePublished":"2023-07-19T00:00:00+00:00","description":"Introduction: Hello! In this project, I’m breaking down the top content creators on Youtube over 2017-2018. The very first thing i’ll do is load the libraries I’m going to use:","headline":"Youtube Top 20 Content Creators","mainEntityOfPage":{"@type":"WebPage","@id":"/projects/2023/07/19/youtube_analysis.html"},"url":"/projects/2023/07/19/youtube_analysis.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Data Engineering Portfolio">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>



















<script>
// Init highlight js
document.addEventListener('DOMContentLoaded', function(event) {
  var els = document.querySelectorAll('pre code')

  function addLangData(block) {
    var outer = block.parentElement.parentElement.parentElement;
    var lang = block.getAttribute('data-lang');
    for (var i = 0; i < outer.classList.length; i++) {
      var cls = outer.classList[i];
      if (cls.startsWith('language-')) {
        lang = cls;
        break;
      }
    }
    if (!lang) {
      cls = block.getAttribute('class');
      lang = cls ? cls.replace('hljs ', '') : '';
    }
    if (lang.startsWith('language-')) {
      lang = lang.substr(9);
    }
    block.setAttribute('class', 'hljs ' + lang);
    block.parentNode.setAttribute('data-lang', lang);
  }

  function addBadge(block) {
    var enabled = ('true' || 'true').toLowerCase();
    if (enabled == 'true') {
      var pre = block.parentElement;
      pre.classList.add('badge');
    }
  }

  function handle(block) {
    addLangData(block);
    addBadge(block)
    hljs.highlightBlock(block);
  }

  for (var i = 0; i < els.length; i++) {
    var el = els[i];
    handle(el);
  }
});
</script>

<style>
  /* code language badge */
  pre.badge::before {
    content: attr(data-lang);
    color: #fff;
    background-color: #28B463;
    padding: 0 .5em;
    border-radius: 0 2px;
    text-transform: lowercase;
    text-align: center;
    min-width: 32px;
    display: inline-block;
    position: absolute;
    right: 0;
  }

  /* fix wrong badge display for firefox browser */
  code > table pre::before {
    display: none;
  }
</style>
</head>
<body>



























































































































<header class="site-header " role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/">
  <img class="site-favicon" title="Data Engineering Portfolio" src="" onerror="this.style.display='none'">
  Data Engineering Portfolio
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/about/">ABOUT</a><a class="page-link" href="/resume/">RESUME</a>









<span class="page-link">



<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://cdn.countryflags.com/thumbs/united-states-of-america/flag-400.png" title="English">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="fr">
          
          <img src="https://cdn.countryflags.com/thumbs/france/flag-400.png" title="French">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="zh-CN">
          
          <img src="https://cdn.countryflags.com/thumbs/china/flag-400.png" title="Chinese(Simple)">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ja">
          
          <img src="https://cdn.countryflags.com/thumbs/japan/flag-400.png" title="Japanese">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ko">
          
          <img src="https://cdn.countryflags.com/thumbs/south-korea/flag-400.png" title="Korean">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ru">
          
          <img src="https://cdn.countryflags.com/thumbs/russia/flag-400.png" title="Russian">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  // Links to cross-origin destinations are unsafe
  var gll = document.getElementsByClassName('goog-logo-link')[0];
  if (gll) {
    gll.setAttribute('rel', 'noopener');
  }

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  function initHeader() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  }
  document.addEventListener('DOMContentLoaded', initHeader);
</script>
















































































































































<script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    hashValue = decodeURIComponent(hashValue);
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.tagName.toLowerCase() == 'a') {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<div class="theme-toggle">
  <input type="checkbox" id="theme-switch">
  <label for="theme-switch">
    <div class="toggle"></div>
    <div class="names">
      <p class="light">Light</p>
      <p class="dark">Dark</p>
    </div>
  </label>
</div>




<script>
  (function() {
    var sw = document.getElementById('theme-switch');
    var html = document.getElementsByTagName('html')[0];
    var nightModeOption = ('light' || 'auto').toLowerCase();
    var storage = nightModeOption === 'manual'
        ? localStorage
        : sessionStorage;
    var themeData = loadThemeData();

    function saveThemeData(data) {
      storage.setItem('theme', JSON.stringify(data));
    }

    function loadThemeData() {
      var data = storage.getItem('theme');
      try {
        data = JSON.parse(data ? data : '');
      } catch(e) {
        data = { nightShift: undefined, autoToggleAt: 0 };
        saveThemeData(data);
      }
      return data;
    }

    function handleThemeToggle(nightShift) {
      themeData.nightShift = nightShift;
      saveThemeData(themeData);
      html.dataset.theme = nightShift ? 'dark' : 'light';
      setTimeout(function() {
        sw.checked = nightShift ? true : false;
      }, 50);
    }

    function autoThemeToggle() {
      // Next time point of theme toggle
      var now = new Date();
      var toggleAt = new Date();
      var hours = now.getHours();
      var nightShift = hours >= 19 || hours <=7;

      if (nightShift) {
        if (hours > 7) {
          toggleAt.setDate(toggleAt.getDate() + 1);
        }
        toggleAt.setHours(7);
      } else {
        toggleAt.setHours(19);
      }

      toggleAt.setMinutes(0);
      toggleAt.setSeconds(0);
      toggleAt.setMilliseconds(0)

      var delay = toggleAt.getTime() - now.getTime();

      // auto toggle theme mode
      setTimeout(function() {
        handleThemeToggle(!nightShift);
      }, delay);

      return {
        nightShift: nightShift,
        toggleAt: toggleAt.getTime()
      };
    }

    // Listen the theme toggle event
    sw.addEventListener('change', function(event) {
      handleThemeToggle(event.target.checked);
    });

    if (nightModeOption == 'auto') {
      var data = autoThemeToggle();

      // Toggle theme by local setting
      if (data.toggleAt > themeData.autoToggleAt) {
        themeData.autoToggleAt = data.toggleAt;
        handleThemeToggle(data.nightShift);
      } else {
        handleThemeToggle(themeData.nightShift);
      }
    } else if (nightModeOption == 'manual') {
      handleThemeToggle(themeData.nightShift);
    } else {
      var nightShift = themeData.nightShift;
      if (nightShift === undefined) {
        nightShift = nightModeOption === 'on';
      }
      handleThemeToggle(nightShift);
    }
  })();
</script>
<div id="click-to-top" class="click-to-top">
  <i class="fa fa-arrow-up"></i>
</div>
<script>
  (function () {
    const clickToTop = document.getElementById('click-to-top');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 100) {
        clickToTop.classList.add('show')
      }else {
        clickToTop.classList.remove('show')
      }
    });
    clickToTop.addEventListener('click', () => {
      window.smoothScrollTo(0);
    });
  })();
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">Youtube Top 20 Content Creators</h1>
  <h2 class="post-subtitle"></h2>

  <p class="post-meta">
    <time class="dt-published" datetime="2023-07-19T00:00:00+00:00" itemprop="datePublished"><i class="fa fa-calendar"></i> Jul 19, 2023
    </time>

    
    
































    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 13 mins</span>
  </p>
<div class="post-tags"><a class="post-tag" href="/tags.html#python">#python</a></div></header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <h2 id="introduction">Introduction:</h2>
<p>Hello! In this project, I’m breaking down the top content creators on Youtube over 2017-2018. The very first thing i’ll do is load the libraries I’m going to use:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sb</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">dt</span>
<span class="kn">import</span> <span class="n">json</span> 
<span class="kn">from</span> <span class="n">itables</span> <span class="kn">import</span> <span class="n">show</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre></div></div>

<p>Next, I’m reading the data into a .csv:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ytube</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">'C:/Users/bruce/Downloads/archive (1)/USvideos.csv'</span><span class="p">)</span>
<span class="n">ytube</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">ytube</span><span class="p">)</span>
</code></pre></div></div>

<p>Afterwards, here’s what everything looks like:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="n">ytube</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>          video_id                                              title  \
3813   NDBwsMIXlMk  Marvel’s Agents of S.H.I.E.L.D. | Season 5 Pre...   
3868   NDBwsMIXlMk  Marvel’s Agents of S.H.I.E.L.D. | Season 5 Pre...   
3928   NDBwsMIXlMk  Marvel’s Agents of S.H.I.E.L.D. | Season 5 Pre...   
3953   6ZfuNTqbHE8  Marvel Studios' Avengers: Infinity War Officia...   
3954   KXHrCBkIxQQ  ALL THE MONEY IN THE WORLD - Official Trailer ...   
...            ...                                                ...   
39536  X2BfTXIwABo                  MARVEL COMICS 2018: A Fresh Start   
39541  X2BfTXIwABo                  MARVEL COMICS 2018: A Fresh Start   
39546  X2BfTXIwABo                  MARVEL COMICS 2018: A Fresh Start   
39551  X2BfTXIwABo                  MARVEL COMICS 2018: A Fresh Start   
39556  X2BfTXIwABo                  MARVEL COMICS 2018: A Fresh Start   

                     channel_title  category_id    category_title  \
3813          Marvel Entertainment           24     Entertainment   
3868          Marvel Entertainment           24     Entertainment   
3928          Marvel Entertainment           24     Entertainment   
3953          Marvel Entertainment           24     Entertainment   
3954   Sony Pictures Entertainment           24     Entertainment   
...                            ...          ...               ...   
39536         Marvel Entertainment            2  Autos &amp; Vehicles   
39541         Marvel Entertainment            2  Autos &amp; Vehicles   
39546         Marvel Entertainment            2  Autos &amp; Vehicles   
39551         Marvel Entertainment            2  Autos &amp; Vehicles   
39556         Marvel Entertainment            2  Autos &amp; Vehicles   

             publish_time trending_date     views    likes  dislikes  \
3813  2017-11-26 16:00:21    2017-11-27    248455     7174       200   
3868  2017-11-26 16:00:21    2017-11-28    456193     9501       294   
3928  2017-11-26 16:00:21    2017-11-29    537443    10577       341   
3953  2017-11-29 13:26:24    2017-11-30  37736281  1735895     21969   
3954  2017-11-29 20:00:53    2017-11-30    197900     2394       372   
...                   ...           ...       ...      ...       ...   
39536 2018-02-20 15:00:05    2018-02-24    377995     9315       704   
39541 2018-02-20 15:00:05    2018-02-25    385064     9404       712   
39546 2018-02-20 15:00:05    2018-02-26    390321     9485       721   
39551 2018-02-20 15:00:05    2018-02-27    394864     9560       728   
39556 2018-02-20 15:00:05    2018-02-28    400237     9618       732   

       comment_count  comments_disabled  ratings_disabled  err_removed  
3813            1291              False             False        False  
3868            1678              False             False        False  
3928            1971              False             False        False  
3953          241237              False             False        False  
3954             432              False             False        False  
...              ...                ...               ...          ...  
39536           2367              False             False        False  
39541           2391              False             False        False  
39546           2419              False             False        False  
39551           2436              False             False        False  
39556           2447              False             False        False  

[640 rows x 14 columns]
</code></pre></div></div>

<p>Now, i’m going to import categories from the JSON file, flatten, then convert into data frame</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="s">'C:/Users/bruce/Downloads/archive (1)/US_category_id.json'</span><span class="p">,</span><span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">ytube_cat</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">())</span>
    
<span class="n">ytube_cat</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="nf">json_normalize</span><span class="p">(</span><span class="n">ytube_cat</span><span class="p">,</span> <span class="n">record_path</span> <span class="o">=</span> <span class="s">'items'</span><span class="p">)</span>
                <span class="p">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'snippet.title'</span><span class="p">]]</span>
                <span class="p">.</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s">'id'</span><span class="p">:</span><span class="s">'category_id'</span><span class="p">,</span> <span class="s">'snippet.title'</span><span class="p">:</span><span class="s">'category_title'</span><span class="p">})</span>
            <span class="p">)</span>

<span class="n">ytube_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">ytube_cat</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">ytube_cat</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   category_id         category_title
0            1       Film &amp; Animation
1            2       Autos &amp; Vehicles
2           10                  Music
3           15         Pets &amp; Animals
4           17                 Sports
5           18           Short Movies
6           19        Travel &amp; Events
7           20                 Gaming
8           21          Videoblogging
9           22         People &amp; Blogs
10          23                 Comedy
11          24          Entertainment
12          25        News &amp; Politics
13          26          Howto &amp; Style
14          27              Education
15          28   Science &amp; Technology
16          29  Nonprofits &amp; Activism
17          30                 Movies
18          31        Anime/Animation
19          32       Action/Adventure
20          33               Classics
21          34                 Comedy
22          35            Documentary
23          36                  Drama
24          37                 Family
25          38                Foreign
26          39                 Horror
27          40         Sci-Fi/Fantasy
28          41               Thriller
29          42                 Shorts
30          43                  Shows
31          44               Trailers
</code></pre></div></div>

<p>The merge I want to do to these dataframes isn’t working because the column’s data types do not align, so let’s see if we can change that…</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ytube</span><span class="p">.</span><span class="n">dtypes</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>video_id                  object
trending_date             object
title                     object
channel_title             object
category_id                int64
publish_time              object
tags                      object
views                      int64
likes                      int64
dislikes                   int64
comment_count              int64
thumbnail_link            object
comments_disabled           bool
ratings_disabled            bool
video_error_or_removed      bool
description               object
dtype: object
</code></pre></div></div>

<p>Part 2</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ytube_cat</span><span class="p">.</span><span class="n">dtypes</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>category_id       object
category_title    object
dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ytube_cat</span><span class="p">[</span><span class="s">'category_id'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ytube_cat</span><span class="p">[</span><span class="s">'category_id'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="s">'int64'</span><span class="p">)</span>

<span class="n">ytube_cat</span><span class="p">.</span><span class="n">dtypes</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>category_id        int64
category_title    object
dtype: object
</code></pre></div></div>

<p>I could keep the text based columns (description and tags) if I wanted to do a text analysis; I’ll explore that another time maybe…</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Trimming the fat
</span>
<span class="n">ytube</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">ytube</span><span class="p">,</span> <span class="n">ytube_cat</span><span class="p">)</span>
           <span class="p">.</span><span class="nf">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s">'video_error_or_removed'</span><span class="p">:</span><span class="s">'err_removed'</span><span class="p">})</span>
           <span class="p">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s">'video_id'</span><span class="p">,</span> <span class="s">'title'</span><span class="p">,</span> <span class="s">'channel_title'</span><span class="p">,</span> <span class="s">'category_id'</span><span class="p">,</span> <span class="s">'category_title'</span><span class="p">,</span> <span class="s">'publish_time'</span><span class="p">,</span> <span class="s">'trending_date'</span><span class="p">,</span>
                  <span class="s">'views'</span><span class="p">,</span> <span class="s">'likes'</span><span class="p">,</span> <span class="s">'dislikes'</span><span class="p">,</span> <span class="s">'comment_count'</span><span class="p">,</span> <span class="s">'comments_disabled'</span><span class="p">,</span> <span class="s">'ratings_disabled'</span><span class="p">,</span> <span class="s">'err_removed'</span><span class="p">]]</span>
        <span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">ytube</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      video_id                                              title  \
0  NDBwsMIXlMk  Marvel’s Agents of S.H.I.E.L.D. | Season 5 Pre...   
1  NDBwsMIXlMk  Marvel’s Agents of S.H.I.E.L.D. | Season 5 Pre...   
2  NDBwsMIXlMk  Marvel’s Agents of S.H.I.E.L.D. | Season 5 Pre...   
3  6ZfuNTqbHE8  Marvel Studios' Avengers: Infinity War Officia...   
4  KXHrCBkIxQQ  ALL THE MONEY IN THE WORLD - Official Trailer ...   

                 channel_title  category_id category_title  \
0         Marvel Entertainment           24  Entertainment   
1         Marvel Entertainment           24  Entertainment   
2         Marvel Entertainment           24  Entertainment   
3         Marvel Entertainment           24  Entertainment   
4  Sony Pictures Entertainment           24  Entertainment   

         publish_time trending_date     views    likes  dislikes  \
0 2017-11-26 16:00:21    2017-11-27    248455     7174       200   
1 2017-11-26 16:00:21    2017-11-28    456193     9501       294   
2 2017-11-26 16:00:21    2017-11-29    537443    10577       341   
3 2017-11-29 13:26:24    2017-11-30  37736281  1735895     21969   
4 2017-11-29 20:00:53    2017-11-30    197900     2394       372   

   comment_count  comments_disabled  ratings_disabled  err_removed  
0           1291              False             False        False  
1           1678              False             False        False  
2           1971              False             False        False  
3         241237              False             False        False  
4            432              False             False        False  
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Change date format for trending dates 
</span>
<span class="n">ytube</span><span class="p">[</span><span class="s">'trending_date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">(</span><span class="n">ytube</span><span class="p">[</span><span class="s">'trending_date'</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s">'%y.%d.%m'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">ytube</span><span class="p">[</span><span class="s">'trending_date'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0       2017-11-14
1       2017-11-14
2       2017-11-14
3       2017-11-14
4       2017-11-14
           ...    
40944   2018-06-02
40945   2018-06-03
40946   2018-06-04
40947   2018-06-05
40948   2018-06-06
Name: trending_date, Length: 40949, dtype: datetime64[ns]
</code></pre></div></div>

<p>Now that everything is pretty much formatted and cleaned, i’m going to plot the only the necessary data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Specify the kind of plot st
</span><span class="n">plt</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="s">'default'</span><span class="p">)</span>


<span class="c1"># Convert 'publish_time' column to datetime
</span><span class="n">ytube</span><span class="p">[</span><span class="s">'publish_time'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">(</span><span class="n">ytube</span><span class="p">[</span><span class="s">'publish_time'</span><span class="p">])</span>
                           <span class="p">.</span><span class="n">dt</span><span class="p">.</span><span class="nf">tz_localize</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
                        <span class="p">)</span>

<span class="c1"># Filter out the ytube for the years 2017 and 2018
</span><span class="n">ytube</span> <span class="o">=</span> <span class="n">ytube</span><span class="p">[(</span><span class="n">ytube</span><span class="p">[</span><span class="s">'publish_time'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="mi">2017</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ytube</span><span class="p">[</span><span class="s">'publish_time'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">2018</span><span class="p">)]</span>

<span class="c1"># Group the ytube by 'category_title' and 'publish_date' (by year and month), then sum up the 'views'
</span><span class="n">ytube_grouped</span> <span class="o">=</span> <span class="n">ytube</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="n">ytube</span><span class="p">[</span><span class="s">'category_title'</span><span class="p">],</span> <span class="n">ytube</span><span class="p">[</span><span class="s">'publish_time'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="nf">to_period</span><span class="p">(</span><span class="s">'M'</span><span class="p">)])[</span><span class="s">'views'</span><span class="p">].</span><span class="nf">sum</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>

<span class="c1"># Pivot the ytube to have 'category_title' as columns and dates as index
</span><span class="n">ytube_pivoted</span> <span class="o">=</span> <span class="n">ytube_grouped</span><span class="p">.</span><span class="nf">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'publish_time'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'category_title'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'views'</span><span class="p">)</span>

<span class="c1"># Plot the time series of each category
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ytube_pivoted</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'line'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">colormap</span> <span class="o">=</span> <span class="s">'tab20'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">'YouTube Views By Category (2017-2018)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'Publish Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">'Views'</span><span class="p">)</span>


<span class="c1"># Change legend title: 
</span><span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">legend</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'Category Title'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/output_10_0.png" alt="png"></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Group the ytube by 'category_title' and 'publish_date' (by year and month), then sum up the 'views'
</span><span class="n">ytube_grouped</span> <span class="o">=</span> <span class="n">ytube</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="n">ytube</span><span class="p">[</span><span class="s">'channel_title'</span><span class="p">],</span> <span class="n">ytube</span><span class="p">[</span><span class="s">'trending_date'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="nf">to_period</span><span class="p">(</span><span class="s">'M'</span><span class="p">)])[</span><span class="s">'views'</span><span class="p">].</span><span class="nf">sum</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>

<span class="c1"># Get top 10 channels by total views
</span><span class="n">top_channels</span> <span class="o">=</span> <span class="n">ytube</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="s">'channel_title'</span><span class="p">)[</span><span class="s">'views'</span><span class="p">].</span><span class="nf">sum</span><span class="p">().</span><span class="nf">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">).</span><span class="n">index</span>

<span class="c1"># Filter the data to include only the top 10 channels
</span><span class="n">ytube</span> <span class="o">=</span> <span class="n">ytube</span><span class="p">[</span><span class="n">ytube</span><span class="p">[</span><span class="s">'channel_title'</span><span class="p">].</span><span class="nf">isin</span><span class="p">(</span><span class="n">top_channels</span><span class="p">)]</span>

<span class="c1"># Group the ytube by 'channel_title' and 'publish_date' (by year and month), then sum up the 'views'
</span><span class="n">ytube_grouped</span> <span class="o">=</span> <span class="n">ytube</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="n">ytube</span><span class="p">[</span><span class="s">'channel_title'</span><span class="p">],</span> <span class="n">ytube</span><span class="p">[</span><span class="s">'publish_time'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="nf">to_period</span><span class="p">(</span><span class="s">'M'</span><span class="p">)])[</span><span class="s">'views'</span><span class="p">].</span><span class="nf">sum</span><span class="p">().</span><span class="nf">reset_index</span><span class="p">()</span>

<span class="c1"># Pivot the data to have 'channel_title' as columns and dates as index
</span><span class="n">ytube_pivoted</span> <span class="o">=</span> <span class="n">ytube_grouped</span><span class="p">.</span><span class="nf">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'publish_time'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'channel_title'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'views'</span><span class="p">)</span>

<span class="c1"># Plot the time series of each channel
</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ytube_pivoted</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Change legend title: 
</span><span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">legend</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="s">'Channel Title'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">'YouTube Views By Channel (Top 20 channels, 2017-2018)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'Publish Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">'Views'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</code></pre></div></div>

<p><img src="/assets/images/output_11_0.png" alt="png"></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Group the ytube by 'category_title' and 'publish_date' (by year and month), then sum up the 'views'
</span><span class="n">ytube_grouped</span> <span class="o">=</span> <span class="p">(</span><span class="n">ytube</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="n">ytube</span><span class="p">[</span><span class="s">'channel_title'</span><span class="p">],</span> <span class="n">ytube</span><span class="p">[</span><span class="s">'likes'</span><span class="p">],</span> <span class="n">ytube</span><span class="p">[</span><span class="s">'dislikes'</span><span class="p">]])[</span><span class="s">'views'</span><span class="p">]</span>
                     <span class="p">.</span><span class="nf">sum</span><span class="p">()</span>
                     <span class="p">.</span><span class="nf">reset_index</span><span class="p">())</span>

<span class="c1"># Get top 20 channels by total views
</span><span class="n">top_channels</span> <span class="o">=</span> <span class="p">(</span><span class="n">ytube</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="s">'channel_title'</span><span class="p">)[</span><span class="s">'views'</span><span class="p">]</span>
                    <span class="p">.</span><span class="nf">sum</span><span class="p">()</span>
                    <span class="p">.</span><span class="nf">nlargest</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
                    <span class="p">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Filter the data to include only the top 20 channels
</span><span class="n">ytube</span> <span class="o">=</span> <span class="n">ytube</span><span class="p">[</span><span class="n">ytube</span><span class="p">[</span><span class="s">'channel_title'</span><span class="p">].</span><span class="nf">isin</span><span class="p">(</span><span class="n">top_channels</span><span class="p">)]</span>

<span class="c1"># Group the data by 'channel_title' and 'publish_date' (by year and month), then sum up the 'views'
</span><span class="n">ytube_grouped</span> <span class="o">=</span> <span class="p">(</span><span class="n">ytube</span><span class="p">.</span><span class="nf">groupby</span><span class="p">([</span><span class="n">ytube</span><span class="p">[</span><span class="s">'channel_title'</span><span class="p">],</span> <span class="n">ytube</span><span class="p">[</span><span class="s">'publish_time'</span><span class="p">]])[</span><span class="s">'likes'</span><span class="p">]</span>
                      <span class="p">.</span><span class="nf">sum</span><span class="p">()</span>
                      <span class="p">.</span><span class="nf">reset_index</span><span class="p">())</span>

<span class="c1"># Pivot the data to have 'channel_title' as columns and dates as index
</span><span class="n">ytube_pivoted</span> <span class="o">=</span> <span class="n">ytube_grouped</span><span class="p">.</span><span class="nf">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'publish_time'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'channel_title'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'likes'</span><span class="p">)</span>

<span class="c1"># Create a scatter plot for each category
</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Specify colormap
</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">get_cmap</span><span class="p">(</span><span class="s">'tab20'</span><span class="p">)</span>  <span class="c1"># Colormap with 20 different colors
</span><span class="n">colors</span> <span class="o">=</span> <span class="nf">cmap</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">ytube_pivoted</span><span class="p">.</span><span class="n">columns</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">ytube_pivoted</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">ytube_pivoted</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ytube_pivoted</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="c1"># Find the maximum value for each channel and label it
</span>    <span class="n">max_val_index</span> <span class="o">=</span> <span class="n">ytube_pivoted</span><span class="p">[</span><span class="n">column</span><span class="p">].</span><span class="nf">idxmax</span><span class="p">()</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="n">ytube_pivoted</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">max_val_index</span><span class="p">,</span> <span class="n">column</span><span class="p">]</span>

    <span class="n">ax</span><span class="p">.</span><span class="nf">text</span><span class="p">(</span><span class="n">max_val_index</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">max_val</span><span class="si">:</span><span class="p">.</span><span class="mi">0</span><span class="n">f</span><span class="si">}</span><span class="s">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">'YouTube Videos By Top 20 Artists, Date and Likes (2017-2018)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">'Time Period'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">'Likes'</span><span class="p">)</span>


<span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">frameon</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">legend</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="s">"Channel Title"</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/images/output_12_0.png" alt="png"></p>



    </div>

</article>
<div class="post-nav">
<a class="previous" href="/misc/2023/07/17/python-test-script.html" title="HR Data Cleaning — A Python test script">HR Data Cleaning — A Python...</a><a class="next" href="/projects/2023/07/19/Using_ETL_with_Rental_Store_Data.html" title="ETL using Rental Store Data? An excursion with SQL and Python">ETL using Rental Store Data? An...</a>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/projects/2023/06/05/STAR_Breakdown.html" title="ETL using Rental Store Data? An excursion with SQL and Python">Characteristics of STARs in Florida</a></li>
<li><a class="post-link" href="/misc/2023/05/04/Tableau-Visualizations-Sample.html" title="ETL using Rental Store Data? An excursion with SQL and Python">Tableau Visualization Showcase</a></li>
<li><a class="post-link" href="/2023/01/31/read-me.html" title="ETL using Rental Store Data? An excursion with SQL and Python">Read Me!</a></li>
<li><a class="post-link" href="/misc/2023/07/17/python-test-script.html" title="ETL using Rental Store Data? An excursion with SQL and Python">HR Data Cleaning — A Python test script</a></li>
</ul>
    </div>
<div class="post-comments"></div></section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title">TOC</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items) {
      var items = menuContent.firstChild.children;

      if (over_items == undefined) {
        over_items = 20;
      }

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
<div>Bruce A. Lee <span class="copyleft">©</span> 2022-2024</div>
      <div>Powered by <a title="Jekyll is a simple, blog-aware, static site
      generator." href="https://jekyllrb.com/">Jekyll</a> &amp; <a title="Yat, yet
      another theme." href="https://github.com/jeffreytse/jekyll-theme-yat">Yat Theme</a>.</div>
      <div class="footer-col rss-subscribe">Subscribe <a href="/feed.xml">via RSS</a>
</div>
    </div>
  </div>
</footer>
</body>
</html>
